# BLDC

## 硬件

### 电机

- 永磁铁做转子，定子为电机电枢，换向使用电子换向，使用6个桥臂的mos管作为电子开关

- 霍尔传感器

  用于检测转子位置，确定换向的时机

## 软件

### 定时器

- 产生6路PWM对mos管进行控制，前提是有驱动电路

### 霍尔传感器

- 使用定时器的霍尔传感器模式，其实就是对三个霍尔传感器口的跳变沿进行检测，检测到后将计时器的计数值保存后继续从零计数，与此同时设定一个定时器通道作为触发检测，在定时器回调函数中进行换向处理。

  > 也可以使用霍尔传感器的三个信号作为外部中断的触发，在中断函数中进行换向处理

  ![1665021218172](.\assets\1665021218172.png)

  ![1665021280955](.\assets\1665021280955.png)

  ![1665021301487](.\assets\1665021301487.png)

  ![1665021243564](.\assets\1665021243564.png)

  ​

### 转速采集

- 使用一个计数变量计数霍尔传感器的跳变沿个数，并在一定周期进行处理，获得转速

  > 需要注意的点是机械角度和电角度的关系，间隔120°电角度安装的霍尔，一个电角度周期跳变6次，而
  >
  > 机械角度=电角度/电机极对数（可以这么理解：霍尔传感器变化一个周期跨过的是相邻的一对极）
  >
  > 转速 = 跳变次数/（6*电机极对数\*采样周期） 采样周期记得换算为分钟为单位，最终单位r/min

- ​